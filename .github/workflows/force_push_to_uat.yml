name: force_push_to_uat

on:
  workflow_call:
    inputs:
      branch_name:
        description: "Branch name to push changes to (e.g., release/SCFA-1234)"
        required: true
        type: string

jobs:
  force_push_to_uat:
    name: Force Push to UAT
    runs-on: ubuntu-latest

    steps:
      - name: Checkout code
        uses: actions/checkout@v4
        with:
          fetch-depth: 0

      - name: Configure Git
        run: |
          git config --global user.email "${{ secrets.DEPLOY_USER_EMAIL }}" 
          git config --global user.name "${{ secrets.DEPLOY_USER_NAME }}"

      - name: Force Push to UAT
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
        run: |
          # Ensure we are in the correct branch
          git checkout "${{ inputs.branch_name }}"
          
          # Force push to UAT branch
          git push origin "${{ inputs.branch_name }}:uat" --force

      - name: Notify Completion
        if: success()
        run: echo "Branch ${{ inputs.branch_name }} has been force pushed to UAT."
